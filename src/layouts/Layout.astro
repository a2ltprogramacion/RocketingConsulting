---
// @src/layouts/Layout.astro
import SeoHead from "../components/atoms/SeoHead.astro";
import "../styles/global.css";

interface Props {
  // Aceptamos el objeto SEO completo del CMS o valores sueltos
  seo?: {
    site_name: string;
    meta_title: string;
    meta_description: string;
    social_image?: string;
  };
  // Fallbacks por si se usa en páginas que no vienen del CMS
  title?: string;
  description?: string;
}

const { seo, title, description } = Astro.props;

// Lógica de Prioridad: CMS > Props Directas > Defaults
const finalTitle = seo?.meta_title || title || "A2LT V-Card";
const finalDescription =
  seo?.meta_description || description || "Servicios Profesionales";
const finalImage = seo?.social_image || undefined;
---

<!doctype html>
<html lang="es" class="scroll-smooth">
  <head>
    <SeoHead
      title={finalTitle}
      description={finalDescription}
      image={finalImage}
    />
    <meta
      name="author"
      content="Ing. Angel Argenis León Torres - A2LT Soluciones"
    />
  </head>

  <body
    class="bg-background text-text font-sans antialiased min-h-screen flex flex-col"
  >
    <slot />

    <script is:inline>
      if (window.netlifyIdentity) {
        window.netlifyIdentity.on("init", (user) => {
          if (!user) {
            window.netlifyIdentity.on("login", () => {
              document.location.href = "/admin/";
            });
          }
        });
      }
    </script>
  </body>
</html>
