---
// @src/components/organisms/Navbar.astro
interface Props {
  siteName: string;
  whatsappLink: string;
}

const { siteName, whatsappLink } = Astro.props;

const navLinks = [
  { name: "Soluciones", href: "#servicios" },
  { name: "Nosotros", href: "#nosotros" },
  { name: "FAQ", href: "#faq" },
];
---

<header
  id="main-header"
  class="fixed top-0 w-full z-50 transition-all duration-300 border-b border-transparent"
>
  <div class="absolute inset-0 bg-background/80 backdrop-blur-md -z-10"></div>

  <div class="container mx-auto px-6 h-20 flex items-center justify-between">
    <a
      href="#"
      class="text-2xl font-heading font-black text-white tracking-tight hover:text-primary transition-colors"
    >
      {siteName}
      <span class="text-primary">.</span>
    </a>

    <nav class="hidden md:flex items-center gap-8">
      {
        navLinks.map((link) => (
          <a
            href={link.href}
            class="text-sm font-medium text-gray-300 hover:text-white transition-colors relative group"
          >
            {link.name}
            <span class="absolute -bottom-1 left-0 w-0 h-0.5 bg-primary transition-all group-hover:w-full" />
          </a>
        ))
      }

      <a
        href={whatsappLink}
        class="flex items-center gap-2 bg-surface border border-white/10 hover:border-primary/50 px-5 py-2.5 rounded-full text-white text-sm font-bold transition-all hover:shadow-[0_0_15px_rgba(255,115,0,0.3)]"
      >
        <span>Hablemos</span>
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="16"
          height="16"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
          ><path
            d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"
          ></path></svg
        >
      </a>
    </nav>

    <button
      id="menu-toggle"
      class="md:hidden text-white p-2 focus:outline-none"
      aria-label="Abrir menú"
    >
      <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"
        ><path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M4 6h16M4 12h16M4 18h16"></path></svg
      >
    </button>
  </div>

  <div
    id="mobile-menu"
    class="fixed inset-0 bg-background/95 backdrop-blur-xl z-40 transform translate-x-full transition-transform duration-300 md:hidden flex flex-col items-center justify-center space-y-8"
  >
    <button
      id="menu-close"
      class="absolute top-6 right-6 text-gray-400 hover:text-white"
    >
      <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"
        ><path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M6 18L18 6M6 6l12 12"></path></svg
      >
    </button>

    {
      navLinks.map((link) => (
        <a
          href={link.href}
          class="mobile-link text-2xl font-heading font-bold text-white hover:text-primary"
        >
          {link.name}
        </a>
      ))
    }

    <a
      href={whatsappLink}
      class="mt-4 bg-primary text-white px-8 py-3 rounded-lg font-bold text-lg"
    >
      Contactar por WhatsApp
    </a>
  </div>
</header>

<script>
  // Lógica "Vanilla" para máximo rendimiento (0kb librerías extra)
  const menuToggle = document.getElementById("menu-toggle");
  const menuClose = document.getElementById("menu-close");
  const mobileMenu = document.getElementById("mobile-menu");
  const mobileLinks = document.querySelectorAll(".mobile-link");
  const header = document.getElementById("main-header");

  function toggleMenu() {
    mobileMenu?.classList.toggle("translate-x-full");
    document.body.classList.toggle("overflow-hidden"); // Evita scroll al abrir menú
  }

  menuToggle?.addEventListener("click", toggleMenu);
  menuClose?.addEventListener("click", toggleMenu);

  // Cerrar menú al hacer click en un enlace
  mobileLinks.forEach((link) => {
    link.addEventListener("click", toggleMenu);
  });

  // Efecto de borde al hacer scroll
  window.addEventListener("scroll", () => {
    if (window.scrollY > 50) {
      header?.classList.add("border-white/10", "bg-background/90");
    } else {
      header?.classList.remove("border-white/10", "bg-background/90");
    }
  });
</script>
